---
title: ä¸º Fuwari æ·»åŠ  Giscus è¯„è®ºç³»ç»Ÿ
published: 2025-10-03
updated: 2025-10-03
description: ''
image: ''
tags: [Fuwari,Giscus]
category: 'å‰ç«¯'
draft: false 
lang: ''
pinned: false
series: 'æ”¹é€ åšå®¢'
---

## ä»‹ç»

**Fuwari** ä½œä¸ºä¸€æ¬¾åŸºäº Astro æ¡†æ¶çš„è½»é‡çº§é™æ€åšå®¢æ¨¡æ¿ï¼Œä»¥å…¶ç®€æ´çš„è®¾è®¡å’Œå“è¶Šçš„æ€§èƒ½å—åˆ°å¼€å‘è€…é’çã€‚ç„¶è€Œï¼Œè¯„è®ºåŠŸèƒ½ä¸€ç›´æ˜¯é™æ€åšå®¢çš„çŸ­æ¿ï¼Œä¼ ç»Ÿè¯„è®ºç³»ç»Ÿå¾€å¾€éœ€è¦å¤æ‚çš„åç«¯é…ç½®å’Œæ•°æ®åº“æ”¯æŒã€‚

æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä¸º Fuwari é™æ€åšå®¢æ— ç¼é›†æˆ **Giscus è¯„è®ºç³»ç»Ÿ**ï¼Œå®ç°åŸºäº GitHub Discussions çš„è½»é‡çº§ã€æ— éœ€æ•°æ®åº“çš„è¯„è®ºè§£å†³æ–¹æ¡ˆã€‚å¹¶å®ç°å…¼å®¹äº®è‰²/æš—è‰²ä¸»é¢˜çš„è‡ªé€‚åº”æ•ˆæœã€‚

## é…ç½®

### å‡†å¤‡ GitHub ä»“åº“

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ GitHub ä¸Šåˆ›å»ºä¸€ä¸ªä¸“é—¨ç”¨äºå­˜å‚¨è¯„è®ºçš„ä»“åº“ã€‚**è¿™ä¸ªä»“åº“å¿…é¡»æ˜¯å…¬å¼€çš„**ï¼Œå› ä¸º Giscus éœ€è¦é€šè¿‡è®¿é—® GitHub ä»“åº“æ¥åŠ è½½å’Œæäº¤è¯„è®ºã€‚

1. **åˆ›å»ºæ–°ä»“åº“**
   - ç™»å½• GitHubï¼Œç‚¹å‡»å³ä¸Šè§’ â€+â€ æŒ‰é’®
   - é€‰æ‹© â€œNew repositoryâ€
   - å¡«å†™ä»“åº“åç§°ï¼ˆå¦‚ `fuwari-comments`ï¼‰å’Œå…¶ä»–å¿…è¦ä¿¡æ¯
   - ç¡®ä¿ä»“åº“å¯è§æ€§è®¾ç½®ä¸º **Public**
2. **å¯ç”¨ Discussions åŠŸèƒ½**
   - è¿›å…¥ä»“åº“çš„ **Settings** â†’ **Features**
   - æ‰¾åˆ° â€œDiscussionsâ€ é€‰é¡¹å¹¶å‹¾é€‰
   - ç‚¹å‡» â€œSave changesâ€ ä¿å­˜
   - Discussions æ˜¯ GitHub ä¸ºé¡¹ç›®è®¨è®ºæä¾›çš„å¹³å°ï¼ŒGiscus å°†åˆ©ç”¨è¿™ä¸€åŠŸèƒ½å­˜å‚¨è¯„è®º

### é…ç½® Giscus

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦é…ç½® Giscus ä»¥å°†è¯„è®ºä¸æˆ‘ä»¬çš„ä»“åº“å…³è”èµ·æ¥ã€‚

1. **è¿æ¥ä»“åº“**
   - å‰å¾€ https://giscus.app/zh-CN
   - é€‰æ‹©è¯­è¨€ååœ¨ä¸‹æ–¹å¡«å†™ä½ çš„ä»“åº“
   - é€šè¿‡æ£€æŸ¥å Discussion å°†è¢«è¿æ¥åˆ°è¯¥ä»“åº“![image-20251003115939818](../_assets/images/image-20251003115939818.png)

2. **é€‰æ‹©æ˜ å°„å…³ç³»** æ¨èé€‰æ‹© `pathname`ï¼Œå‡å¦‚ä½ çš„æ–‡ç« è·¯å¾„ä¸º `posts/helloworld`ï¼Œé‚£ä¹ˆåªè¦ä½ ä¿è¯è¿™ä¸ªè·¯å¾„ä¸å˜ï¼Œè¯„è®ºå’Œé¡µé¢å°±æ°¸è¿œåŒ¹é…![image-20251003120040606](../_assets/images/image-20251003120040606.png)

3. **é€‰æ‹© Discussion åˆ†ç±»** æ¨èä½¿ç”¨ **å…¬å‘Šï¼ˆAnnouncementsï¼‰** ç±»å‹çš„åˆ†ç±»ï¼Œä»¥ç¡®ä¿æ–° discussion åªèƒ½ç”±ä»“åº“ç»´æŠ¤è€…å’Œ giscus åˆ›å»º![image-20251003120131231](../_assets/images/image-20251003120131231.png)

4. **è·å–é…ç½®ä¿¡æ¯**

   å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œè®°å½•ä»¥ä¸‹é…ç½®ä¿¡æ¯ï¼Œç¨åå°†åœ¨ Fuwari ä¸­ä½¿ç”¨ï¼š

   - ä»“åº“åç§°
   - ä»“åº“ ID
   - åˆ†ç±»åç§°
   - åˆ†ç±» ID

![image-20251003120516834](../_assets/images/image-20251003120516834.png)

### æ·»åŠ åˆ° Fuwari

1. **åˆ›å»º Giscus ç»„ä»¶**

   ä¸ºäº†å®ç°åœ¨äº®è‰²/æš—è‰²ä¸‹éƒ½èƒ½ä½¿ Giscus å®Œç¾æ˜¾ç¤º,æˆ‘ä»¬éœ€è¦åœ¨ `src/components/misc/` ç›®å½•ä¸‹åˆ›å»º `Giscus.astro` æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```js title="src/components/misc/Giscus.astro" 
---
interface Props {
  repo: string;
  repoId: string;
  category: string;
  categoryId: string;
  mapping?: string;
  reactionsEnabled?: boolean;
  emitMetadata?: boolean;
  inputPosition?: 'top' | 'bottom';
  lang?: string;
}

const {
  repo,
  repoId,
  category,
  categoryId,
  mapping = 'pathname',
  reactionsEnabled = true,
  emitMetadata = false,
  inputPosition = 'bottom',
  lang = 'zh-CN'
} = Astro.props;
---

<div id="giscus-container"></div>

<script define:vars={{ repo, repoId, category, categoryId, mapping, reactionsEnabled, emitMetadata, inputPosition, lang }}>
  function loadGiscus() {
    const container = document.getElementById('giscus-container');
    if (!container) return;

    const isDark = document.documentElement.classList.contains('dark');
    const theme = isDark ? 'dark' : 'light';

    const script = document.createElement('script');
    script.src = 'https://giscus.app/client.js';
    script.setAttribute('data-repo', repo);
    script.setAttribute('data-repo-id', repoId);
    script.setAttribute('data-category', category);
    script.setAttribute('data-category-id', categoryId);
    script.setAttribute('data-mapping', mapping);
    script.setAttribute('data-strict', '0');
    script.setAttribute('data-reactions-enabled', reactionsEnabled ? '1' : '0');
    script.setAttribute('data-emit-metadata', emitMetadata ? '1' : '0');
    script.setAttribute('data-input-position', inputPosition);
    script.setAttribute('data-theme', theme);
    script.setAttribute('data-lang', lang);
    script.setAttribute('data-loading', 'lazy');
    script.crossOrigin = 'anonymous';
    script.async = true;

    container.appendChild(script);
  }

  // ç›‘å¬ä¸»é¢˜å˜åŒ–
  function updateGiscusTheme() {
    const giscusFrame = document.querySelector('iframe[src*="giscus"]');
    if (giscusFrame) {
      const isDark = document.documentElement.classList.contains('dark');
      const theme = isDark ? 'dark' : 'light';

      giscusFrame.contentWindow.postMessage({
        giscus: {
          setConfig: {
            theme: theme
          }
        }
      }, 'https://giscus.app');
    }
  }

  // ç›‘å¬DOMå˜åŒ–æ¥æ£€æµ‹ä¸»é¢˜åˆ‡æ¢
  const observer = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
        updateGiscusTheme();
      }
    });
  });

  // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadGiscus);
  } else {
    loadGiscus();
  }

  // å¼€å§‹è§‚å¯Ÿä¸»é¢˜å˜åŒ–
  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ['class']
  });
</script>
```

2. **æ·»åŠ åˆ°æ–‡ç« é¡µé¢**

   åœ¨ `src/pages/posts/[...slug].astro` æ–‡ä»¶ä¸­ï¼š

   - é¦–å…ˆå¯¼å…¥ Giscus ç»„ä»¶ï¼š

```js title="src/pages/posts/[...slug].astro" ins={2}
import path from "node:path";
import Giscus from "@components/misc/Giscus.astro";
import License from "@components/misc/License.astro";
import Markdown from "@components/misc/Markdown.astro";
import I18nKey from "@i18n/i18nKey";
import { i18n } from "@i18n/translation";
import MainGridLayout from "@layouts/MainGridLayout.astro";
import { getSortedPosts } from "@utils/content-utils";
import { getDir, getPostUrlBySlug } from "@utils/url-utils";
import { Icon } from "astro-icon/components";
import { licenseConfig } from "src/config";
import ImageWrapper from "../../components/misc/ImageWrapper.astro";
import PostMetadata from "../../components/PostMeta.astro";
import { profileConfig, siteConfig } from "../../config";
import { formatDateToYYYYMMDD } from "../../utils/date-utils";
```

- ç„¶ååœ¨è®¸å¯è¯ç»„ä»¶ä¹‹åæ·»åŠ  Giscus ç»„ä»¶ï¼š

```js title="src/pages/posts/[...slug].astro" ins={13,20}
 <!-- always show cover as long as it has one -->

            {entry.data.image &&
                <ImageWrapper id="post-cover" src={entry.data.image} basePath={path.join("content/posts/", getDir(entry.id))} class="mb-8 rounded-xl banner-container onload-animation"/>
            }


            <Markdown class="mb-6 markdown-content onload-animation">
                <Content />
            </Markdown>

            {licenseConfig.enable && <License title={entry.data.title} slug={entry.slug} pubDate={entry.data.published} class="mb-6 rounded-xl license-container onload-animation"></License>}
            <!-- è¯„è®ºæ¨¡å— -->
            <Giscus
                repo="luozhipeng1/fuwari"
                repoId="R_kgDOPvEVqw"
                category="Announcements"
                categoryId="DIC_kwDOPvEVq84CwMEH"
            />
            <br> 
        </div>
    </div>
```

ä¿å­˜æ–‡ä»¶åé‡æ–°æ„å»ºé¡¹ç›®å³å¯çœ‹åˆ°è¯„è®ºåŒº

é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä½ å°±æˆåŠŸä¸º **Fuwari** æ·»åŠ äº†åŠŸèƒ½å®Œå–„çš„è¯„è®ºç³»ç»Ÿï¼Œï¼ğŸ‰